<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>✨ 숙소 및 아이돌봄 견적 계산기 ✨</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- React 및 ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Custom styles for better aesthetics and responsiveness */
        body {
            font-family: 'Inter', sans-serif;
        }
        input[type="radio"]:checked + span {
            /* Styles for checked radio labels */
            color: #4c1d95; /* Deep purple */
            font-weight: 700; /* Bold */
        }
        input[type="checkbox"]:checked + div > span:first-child {
            /* Styles for checked checkbox labels */
            color: #166534; /* Deep green */
            font-weight: 700; /* Bold */
        }
        /* Ensure smooth transitions for layout changes */
        .transition-all {
            transition-property: all;
            transition-duration: 300ms;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // 숙소 가격 및 기준 정보
        // '남해' 지역과 '제천' 지역의 숙소 타입별 주중/주말/요일별 가격, 기준 인원, 최대 인원 정보가 포함됩니다.
        const ACCOMMODATION_PRICING = {
            '남해': {
                'A': {
                    prices: {
                        0: 260000, // Sunday (수정됨: 주말에서 평일 가격으로)
                        1: 260000, // Monday
                        2: 260000, // Tuesday
                        3: 260000, // Wednesday
                        4: 260000, // Thursday
                        5: 280000, // Friday
                        6: 280000  // Saturday
                    },
                    baseGuests: 2, maxGuests: 4, linkUrl: 'https://sodope.co.kr/space'
                },
                'B': {
                    prices: {
                        0: 170000, // Sunday (수정됨: 주말에서 평일 가격으로)
                        1: 170000, // Monday
                        2: 170000, // Tuesday
                        3: 170000, // Wednesday
                        4: 170000, // Thursday
                        5: 190000, // Friday
                        6: 190000  // Saturday
                    },
                    baseGuests: 2, maxGuests: 2, linkUrl: 'https://sodope.co.kr/space'
                },
                'C': {
                    prices: {
                        0: 170000, // Sunday (수정됨: 주말에서 평일 가격으로)
                        1: 170000, // Monday
                        2: 170000, // Tuesday
                        3: 170000, // Wednesday
                        4: 170000, // Thursday
                        5: 190000, // Friday
                        6: 190000  // Saturday
                    },
                    baseGuests: 2, maxGuests: 2, linkUrl: 'https://sodope.co.kr/space'
                },
            },
            '제천': {
                '패밀리룸': {
                    prices: {
                        0: 137000, // Sunday
                        1: 137000, // Monday
                        2: 137000, // Tuesday
                        3: 137000, // Wednesday
                        4: 209000, // Thursday night (금~토 예약 시 금요일 밤 요금)
                        5: 229000, // Friday night (토~일 예약 시 토요일 밤 요금)
                        6: 137000  // Saturday
                    },
                    baseGuests: 2, maxGuests: 4, linkUrl: 'https://www.clubes.co.kr/resort/jecheon/rooms_detail/?room_type=family'
                },
                '로얄': {
                    prices: {
                        0: 195000, // Sunday
                        1: 195000, // Monday
                        2: 195000, // Tuesday
                        3: 195000, // Wednesday
                        4: 269000, // Thursday night
                        5: 279000, // Friday night
                        6: 195000  // Saturday
                    },
                    baseGuests: 4, maxGuests: 6, linkUrl: 'https://www.clubes.co.kr/resort/jecheon/rooms_detail/?room_type=royal'
                }
            }
        };

        // 프리미엄 아이돌봄 서비스 관련 설정
        const CHILDCARE_CONFIG = {
            baseChildcareCostNamhae: 150000, // 남해 아이돌봄 기본 비용 (1박 기준)
            baseChildcareCostJecheon: 140000, // 제천 아이돌봄 기본 비용 (1박 기준)
            
            baseChildcareGuests: 1, // 아이돌봄 서비스 기준인원 (1명부터 제공)
            additionalChildcareFeePerChild: 50000, // 기준인원 초과 시 1명당 추가 요금 (1박당)
            maxChildrenPerTeacher: 6, // 한 돌봄교사가 돌볼 수 있는 최대 아이 수 (교사 수 산출용)
            
            // 돌봄 서비스 시간
            hoursNamhae: "1:00 PM - 6:00 PM",
            hoursJecheon: "1:30 PM - 6:00 PM",
        };

        // 소셜 다이닝 설정
        const SOCIAL_DINING_CONFIG = {
            costPerPerson: 30000, // 남해 소셜 다이닝 인당 비용
            menuExamples: [
                "남해 홍합밥",
                "남해 돌문어플레이트",
                "남해 참돔과 미나리지리탕"
            ]
        };

        // 돌봄 프로그램 상세 설명
        const CHILDCARE_PROGRAM_DESCRIPTIONS = {
            '아침열기': "하루 일과를 시작하기 전 부모님과 아이들은 손뼉을 부딪치고 눈을 마주보며 온기를 나누고, 서로에게 따뜻한 응원 한마디를 전하며 기분좋은 하루를 시작해요.",
            '자연체험(은모래해변)': "맑은 공기를 마시고 새의 노랫소리를 들으며, 자연물을 통한 자유놀이로 자연을 온전히 느끼는 시간을 보내요.",
            '자연체험(숲산책)': "맑은 공기를 마시고 새의 노랫소리를 들으며, 자연물을 통한 자유놀이로 자연을 온전히 느끼는 시간을 보내요.",
            '습식수채화': "천연 재료로 만든 스토크마 물감을 사용하여 자신만의 그림을 완성해요. 그리는 동안 변화하는 색을 느끼며 예술을 통한 치유를 경험해요.",
            '수공예': "수놓기, 실팔찌, 지끈 바구니 등을 손을 이용해 만드는 시간을 가져요. 수작업을 반복하면서 소근육이 발달되고 상상력과 집중력을 발휘하며 몰입의 즐거움을 느껴요.",
            '모둠놀이': "자연에서 찾은 자연물을 가지고 실내, 실외에서 노래를 부르며 함께하는 놀이시간을 가져요. 이 시간을 통해 아이들은 친구들과 경쟁이 아닌 협력과 협동을 배워요.",
            '하루닫기': "부모님과 아이들 모두 각자의 시간을 온전히 보낸 후, 가족이 다시 모여오늘 하루의 경험들을 나누며 가족이 하나되는 시간을 가져요."
        };

        // 돌봄 프로그램 구성표 (지역별)
        const CHILDCARE_PROGRAMS = {
            '남해': [
                "아침열기",
                "자연체험(은모래해변)",
                "습식수채화",
                "수공예",
                "모둠놀이",
                "하루닫기"
            ],
            '제천': [
                "아침열기",
                "자연체험(숲산책)",
                "습식수채화",
                "수공예",
                "모둠놀이",
                "하루닫기"
            ]
        };

        // 요일 배열 (JavaScript Date.getDay() 결과와 매핑: 0=일, 1=월, ..., 6=토)
        const DAYS_OF_WEEK_KO = ['일', '월', '화', '수', '목', '금', '토'];

        // 특정 날짜 밤의 숙박 가격을 가져오는 헬퍼 함수
        const getPriceForNight = (location, roomType, date) => {
            const roomInfo = ACCOMMODATION_PRICING[location]?.[roomType];
            if (!roomInfo) return 0;

            const dayOfWeekIndex = date.getDay(); // 0: Sunday, 1: Monday, ... 6: Saturday
            // 남해와 제천 모두 'prices' 객체를 사용하도록 통합
            return roomInfo.prices[dayOfWeekIndex] || 0;
        };

        // 캘린더 날짜 생성 함수
        const generateCalendarDates = (year, month) => {
            const firstDayOfMonth = new Date(year, month, 1);
            const lastDayOfMonth = new Date(year, month + 1, 0);
            const numDaysInMonth = lastDayOfMonth.getDate();

            const dates = [];
            let currentWeek = [];

            // Add leading empty cells for days before the 1st of the month
            for (let i = 0; i < firstDayOfMonth.getDay(); i++) {
                currentWeek.push(null);
            }

            for (let day = 1; day <= numDaysInMonth; day++) {
                const currentDate = new Date(year, month, day);
                currentWeek.push(currentDate);

                if (currentWeek.length === 7) {
                    dates.push(currentWeek);
                    currentWeek = [];
                }
            }

            // Add trailing empty cells for days after the last of the month
            if (currentWeek.length > 0) {
                while (currentWeek.length < 7) {
                    currentWeek.push(null);
                }
                dates.push(currentWeek);
            }
            return dates;
        };


        // App Component: Manages the main logic and UI for the quotation system.
        function App() {
            const { useState, useEffect } = React;

            // 숙소 관련 상태 정의
            const [selectedLocation, setSelectedLocation] = useState('남해');
            const [selectedRoomType, setSelectedRoomType] = useState('A');
            const [startDate, setStartDate] = useState(null); // 실제 날짜 객체로 저장
            const [endDate, setEndDate] = useState(null);   // 실제 날짜 객체로 저장
            const [totalGuests, setTotalGuests] = useState(2);

            // 아이돌봄 서비스 관련 상태 정의
            const [children4To12, setChildren4To12] = useState(0);
            const [isChildcareServiceSelected, setIsChildcareServiceSelected] = useState(false);
            const [selectedProgramName, setSelectedProgramName] = useState(null);
            const [selectedProgramDescription, setSelectedProgramDescription] = useState(null);

            // 선택 옵션 상품 관련 상태
            const [isSocialDiningSelected, setIsSocialDiningSelected] = useState(false);

            // 캘린더 상태
            const [currentMonth, setCurrentMonth] = useState(new Date()); // 캘린더에 표시될 현재 월

            // 최종 총 견적 금액
            const [totalEstimate, setTotalEstimate] = useState(0);
            const [accommodationOnlyCost, setAccommodationOnlyCost] = useState(0);
            const [childcareOnlyCost, setChildcareOnlyCost] = useState(0);
            const [socialDiningOnlyCost, setSocialDiningOnlyCost] = useState(0);

            // 예약자 정보 상태
            const [requesterName, setRequesterName] = useState('');
            const [phoneNumber, setPhoneNumber] = useState('');


            // 선택된 지역에 따라 기본 룸 타입 초기화
            useEffect(() => {
                if (selectedLocation === '남해') {
                    setSelectedRoomType('A');
                } else if (selectedLocation === '제천') {
                    const jecheonRoomTypes = Object.keys(ACCOMMODATION_PRICING['제천']);
                    setSelectedRoomType(jecheonRoomTypes.includes('패밀리룸') ? '패밀리룸' : jecheonRoomTypes[0]);
                }
                if (selectedLocation === '제천') {
                    setIsSocialDiningSelected(false);
                }
                setSelectedProgramName(null);
                setSelectedProgramDescription(null);
            }, [selectedLocation]);

            // 숙박 기간 계산 (총 박/일)
            const calculateDuration = (start, end) => {
                if (!start || !end) return { numDays: 0, numNights: 0 };
                const diffTime = Math.abs(end.getTime() - start.getTime());
                const numDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1; // 시작일과 종료일 모두 포함
                const numNights = numDays > 0 ? numDays - 1 : 0;
                return { numDays, numNights };
            };

            const { numDays, numNights } = calculateDuration(startDate, endDate);

            // 총 견적 계산 로직
            useEffect(() => {
                let currentAccommodationCost = 0;
                let currentChildcareServiceCost = 0;
                let currentSocialDiningCost = 0;

                const locationPricing = ACCOMMODATION_PRICING[selectedLocation];
                const roomInfo = selectedRoomType ? locationPricing?.[selectedRoomType] : null;

                // 1. 숙소 가격 계산
                if (roomInfo && !roomInfo.message && startDate && endDate) {
                    if (totalGuests <= roomInfo.maxGuests) {
                        let tempDate = new Date(startDate);
                        for (let i = 0; i < numNights; i++) {
                            currentAccommodationCost += getPriceForNight(selectedLocation, selectedRoomType, tempDate);
                            tempDate.setDate(tempDate.getDate() + 1); // 다음 날짜로 이동
                        }

                        if (totalGuests > roomInfo.baseGuests) {
                            const additionalGuests = totalGuests - roomInfo.baseGuests;
                            currentAccommodationCost += additionalGuests * 20000 * numNights; // 인원 추가 비용도 박수 기준으로
                        }
                    }
                }
                setAccommodationOnlyCost(currentAccommodationCost);

                // 2. 프리미엄 아이돌봄 서비스 계산
                if (isChildcareServiceSelected && children4To12 > 0 && startDate && endDate) {
                    let baseChildcareCostPerNightForLocation = 0;
                    if (selectedLocation === '남해') {
                        baseChildcareCostPerNightForLocation = CHILDCARE_CONFIG.baseChildcareCostNamhae;
                    } else if (selectedLocation === '제천') {
                        baseChildcareCostPerNightForLocation = CHILDCARE_CONFIG.baseChildcareCostJecheon;
                    }

                    const additionalChildrenForChildcare = children4To12 > CHILDCARE_CONFIG.baseChildcareGuests ?
                                                            children4To12 - CHILDCARE_CONFIG.baseChildcareGuests : 0;

                    let tempDateForChildcare = new Date(startDate);
                    for (let i = 0; i < numNights; i++) {
                        // 일요일은 돌봄 서비스가 제공되지 않음 (getDay()는 일요일을 0으로 반환)
                        if (tempDateForChildcare.getDay() !== 0) { // Check if it's NOT Sunday
                            currentChildcareServiceCost += baseChildcareCostPerNightForLocation;
                            currentChildcareServiceCost += additionalChildrenForChildcare * CHILDCARE_CONFIG.additionalChildcareFeePerChild;
                        }
                        tempDateForChildcare.setDate(tempDateForChildcare.getDate() + 1); // 다음 날짜로 이동
                    }
                }
                setChildcareOnlyCost(currentChildcareServiceCost);

                // 3. 소셜 다이닝 비용 계산 (남해에서만)
                if (isSocialDiningSelected && selectedLocation === '남해') {
                    currentSocialDiningCost = SOCIAL_DINING_CONFIG.costPerPerson * totalGuests;
                }
                setSocialDiningOnlyCost(currentSocialDiningCost);

                setTotalEstimate(currentAccommodationCost + currentChildcareServiceCost + currentSocialDiningCost);
            }, [selectedLocation, selectedRoomType, startDate, endDate, totalGuests, children4To12, isChildcareServiceSelected, isSocialDiningSelected, numNights]); // 이펙트 의존성 배열


            // 캘린더 날짜 클릭 핸들러
            const handleDateClick = (date) => {
                // 오늘 날짜 이전은 선택 불가
                const todayForComparison = new Date();
                todayForComparison.setHours(0, 0, 0, 0);
                if (!date || (date < todayForComparison && date.toDateString() !== todayForComparison.toDateString())) {
                    return;
                }

                if (!startDate || (startDate && endDate)) {
                    setStartDate(date);
                    setEndDate(null);
                } else if (date < startDate) {
                    setStartDate(date);
                    setEndDate(null);
                } else {
                    setEndDate(date);
                }
            };

            // 캘린더 월 이동 핸들러 (오늘 날짜 기준으로 -1개월 ~ +1개월 범위 제한)
            const handleMonthChange = (offset) => {
                setCurrentMonth(prevMonth => {
                    const newMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth() + offset, 1);
                    
                    const todayMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);
                    const oneMonthAgo = new Date(today.getFullYear(), today.getMonth() - 1, 1);
                    const oneMonthLater = new Date(today.getFullYear(), today.getMonth() + 1, 1);

                    // Allow navigating to current month, one month before, and one month after
                    if (newMonth.getTime() < oneMonthAgo.getTime() || newMonth.getTime() > oneMonthLater.getTime()) {
                        return prevMonth; // 범위를 벗어나면 이동하지 않음
                    }
                    return newMonth;
                });
            };


            // 숙소 인원 정보 및 초과 메시지 표시
            const getAccommodationGuestInfo = () => {
                const locationPricing = ACCOMMODATION_PRICING[selectedLocation];
                const roomInfo = selectedRoomType ? locationPricing?.[selectedRoomType] : null;

                if (!roomInfo) return null;

                // This message check seems redundant if ACCOMMODATION_PRICING always has valid data for selectedLocation
                // and selectedRoomType. Keeping for robustness if data structure changes.
                if (locationPricing && locationPricing[Object.keys(locationPricing)[0]]?.message) {
                    return (
                        <p className="text-gray-600 text-base mt-2">
                            선택하신 지역 ({selectedLocation})의 숙소 가격 정보가 현재 없습니다.
                        </p>
                    );
                }

                if (totalGuests > roomInfo.maxGuests) {
                    return (
                        <p className="text-red-500 font-bold text-xl sm:text-2xl mt-2">
                            최대인원을 초과하였습니다. ({totalGuests}인 / 최대 {roomInfo.maxGuests}인)
                        </p>
                    );
                }
                
                return (
                    <p className="text-gray-700 text-base mt-2">
                        기준 {roomInfo.baseGuests}인, 최대 {roomInfo.maxGuests}인 수용 가능
                    </p>
                );
            };

            // 총 숙박 인원 증감 핸들러
            const handleGuestsIncrement = () => {
                setTotalGuests(prevGuests => prevGuests + 1);
            };

            const handleGuestsDecrement = () => {
                setTotalGuests(prevGuests => Math.max(1, prevGuests - 1));
                // If reducing totalGuests makes children4To12 greater than totalGuests, adjust children4To12
                if (children4To12 > Math.max(1, totalGuests - 1)) {
                    setChildren4To12(Math.max(1, totalGuests - 1));
                }
            };

            // 돌봄이 필요한 자녀 수 증감 핸들러
            const handleChildrenIncrement = () => {
                setChildren4To12(prevChildren => Math.min(totalGuests, prevChildren + 1));
            };

            const handleChildrenDecrement = () => {
                setChildren4To12(prevChildren => Math.max(0, prevChildren - 1));
            };

            // 돌봄 프로그램 클릭 핸들러
            const handleProgramClick = (programName) => {
                setSelectedProgramName(programName);
                setSelectedProgramDescription(CHILDCARE_PROGRAM_DESCRIPTIONS[programName]);
            };

            // 현재 선택된 룸의 상세 설명 링크 가져오기
            const currentRoomLink = ACCOMMODATION_PRICING[selectedLocation]?.[selectedRoomType]?.linkUrl;

            // Google Apps Script Web App URL
            const GOOGLE_APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzksuJK7iOpRla1N-JQnLE24IZGyXGaboUxc3-3trCysJEQpISLP9gzTeKCH00GG755/exec";

            // 예약 상담하기 버튼 클릭 핸들러
            const handleSubmitBooking = async () => {
                if (!startDate || !endDate) {
                    window.prompt("숙박 날짜를 선택해주세요.");
                    return;
                }
                if (totalGuests < 1) {
                    window.prompt("총 숙박 인원을 1명 이상으로 설정해주세요.");
                    return;
                }
                if (!requesterName.trim()) {
                    window.prompt("예약자 이름을 입력해주세요.");
                    return;
                }
                if (!phoneNumber.trim()) {
                    window.prompt("전화번호를 입력해주세요.");
                    return;
                }

                const confirmBooking = window.confirm("예약 상담을 진행하시겠습니까? 입력하신 정보가 Google Sheet에 기록됩니다.");
                if (!confirmBooking) {
                    return;
                }

                // 전송할 데이터 구성
                const bookingData = {
                    requesterName: requesterName,
                    phoneNumber: phoneNumber,
                    location: selectedLocation,
                    roomType: selectedRoomType,
                    startDate: startDate.toLocaleDateString('ko-KR'), // Use ko-KR locale for consistent date format
                    endDate: endDate.toLocaleDateString('ko-KR'),
                    totalGuests: totalGuests,
                    children4To12: children4To12,
                    isChildcareServiceSelected: isChildcareServiceSelected ? "예" : "아니오",
                    isSocialDiningSelected: isSocialDiningSelected ? "예" : "아니오",
                    totalEstimate: totalEstimate.toLocaleString('ko-KR') + "원 (부가세 포함)"
                };

                try {
                    const response = await fetch(GOOGLE_APPS_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(bookingData),
                    });

                    window.prompt("예약 상담 요청이 접수되었습니다. 담당자가 곧 연락드릴 예정입니다.");

                } catch (error) {
                    console.error("예약 상담 요청 실패:", error);
                    window.prompt("예약 상담 요청 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.");
                }
            };

            // 캘린더 생성
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Set today to start of day for comparison accuracy
            const currentYear = currentMonth.getFullYear();
            const currentMon = currentMonth.getMonth();
            const calendarDates = generateCalendarDates(currentYear, currentMon);

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 p-4 sm:p-6 lg:p-8 flex items-center justify-center font-sans">
                    <div className="bg-white p-6 sm:p-8 md:p-10 rounded-3xl shadow-xl w-full max-w-4xl border border-gray-200">
                        <h1 className="text-3xl sm:text-4xl font-extrabold text-center text-indigo-800 mb-8 sm:mb-10">
                            ✨ 숙소 및 아이돌봄 견적 계산기 ✨
                        </h1>

                        {/* 지역 선택 섹션 */}
                        <div className="mb-6 bg-blue-50 p-4 sm:p-6 rounded-2xl border border-blue-200 shadow-sm">
                            <h2 className="text-xl sm:text-2xl font-bold text-blue-700 mb-4 pb-2 border-b border-blue-300">
                                지역 선택
                            </h2>
                            <div className="flex flex-wrap gap-4">
                                {Object.keys(ACCOMMODATION_PRICING).map(location => (
                                    <label key={location} className="flex items-center p-3 bg-white rounded-xl shadow-md cursor-pointer hover:bg-blue-100 transition-all duration-200 border border-gray-100">
                                        <input
                                            type="radio"
                                            name="location"
                                            value={location}
                                            checked={selectedLocation === location}
                                            onChange={(e) => setSelectedLocation(e.target.value)}
                                            className="form-radio h-5 w-5 text-blue-600 rounded-full focus:ring-blue-500 mr-2"
                                        />
                                        <span className="text-base sm:text-lg font-medium text-gray-800">{location}</span>
                                    </label>
                                ))}
                            </div>
                        </div>

                        {/* 숙소 타입, 숙박 요일, 인원 선택 섹션 */}
                        {selectedLocation && ACCOMMODATION_PRICING[selectedLocation] && (
                            <div className="mb-6 bg-purple-50 p-4 sm:p-6 rounded-2xl border border-purple-200 shadow-sm">
                                <h2 className="text-xl sm:text-2xl font-bold text-purple-700 mb-4 pb-2 border-b border-purple-300">
                                    숙소 선택 및 인원
                                </h2>
                                {ACCOMMODATION_PRICING[selectedLocation][Object.keys(ACCOMMODATION_PRICING[selectedLocation])[0]]?.message ? (
                                    <div className="bg-red-50 p-4 rounded-xl border border-red-200 text-red-700">
                                        <p>선택하신 지역 ({selectedLocation})의 숙소 가격 정보가 현재 없습니다.</p>
                                    </div>
                                ) : (
                                    <>
                                        {/* 룸 타입 선택 */}
                                        <div className="mb-4">
                                            <span className="block text-gray-700 text-lg font-semibold mb-2">룸 타입:</span>
                                            <div className="flex flex-wrap gap-4">
                                                {Object.keys(ACCOMMODATION_PRICING[selectedLocation]).map(roomType => (
                                                    <label key={roomType} className="flex items-center p-3 bg-white rounded-xl shadow-md cursor-pointer hover:bg-purple-100 transition-all duration-200 border border-gray-100">
                                                        <input
                                                            type="radio"
                                                            name="roomType"
                                                            value={roomType}
                                                            checked={selectedRoomType === roomType}
                                                            onChange={(e) => setSelectedRoomType(e.target.value)}
                                                            className="form-radio h-5 w-5 text-purple-600 rounded-full focus:ring-purple-500 mr-2"
                                                        />
                                                        <span className="text-base sm:text-lg font-medium text-gray-800">{roomType}</span>
                                                    </label>
                                                ))}
                                            </div>
                                        </div>

                                        {/* 숙소 정보 (기준/최대 인원 및 링크) */}
                                        <div className="mb-4">
                                            {getAccommodationGuestInfo()}
                                            {currentRoomLink && (
                                                <a
                                                    href={currentRoomLink}
                                                    target="_blank"
                                                    rel="noopener noreferrer"
                                                    className="mt-2 text-purple-600 hover:text-purple-800 font-semibold text-base sm:text-lg underline transition-colors duration-200 block"
                                                >
                                                    숙소 자세히 보기
                                                </a>
                                            )}
                                        </div>

                                        {/* 숙박 날짜 선택 (캘린더) */}
                                        <div className="mb-4">
                                            <span className="block text-gray-700 text-lg font-semibold mb-2">숙박 날짜:</span>
                                            <div className="bg-white rounded-lg shadow-md p-4">
                                                <div className="flex justify-between items-center mb-4">
                                                    <button
                                                        onClick={() => handleMonthChange(-1)}
                                                        className="p-2 rounded-full hover:bg-gray-200 transition-colors"
                                                        aria-label="Previous month"
                                                    >
                                                        &lt;
                                                    </button>
                                                    <h3 className="text-lg font-bold">
                                                        {currentMonth.getFullYear()}년 {currentMonth.getMonth() + 1}월
                                                    </h3>
                                                    <button
                                                        onClick={() => handleMonthChange(1)}
                                                        className="p-2 rounded-full hover:bg-gray-200 transition-colors"
                                                        aria-label="Next month"
                                                    >
                                                        &gt;
                                                    </button>
                                                </div>
                                                <div className="grid grid-cols-7 text-center font-bold text-sm mb-2">
                                                    {DAYS_OF_WEEK_KO.map(day => (
                                                        <span key={day} className={day === '일' ? 'text-red-500' : (day === '토' ? 'text-blue-500' : '')}>
                                                            {day}
                                                        </span>
                                                    ))}
                                                </div>
                                                <div className="grid grid-cols-7 gap-1">
                                                    {calendarDates.flat().map((date, index) => {
                                                        const isToday = date && date.toDateString() === today.toDateString();
                                                        const isSelectedStart = startDate && date && date.toDateString() === startDate.toDateString();
                                                        const isSelectedEnd = endDate && date && date.toDateString() === endDate.toDateString();
                                                        const isInRange = startDate && endDate && date && date > startDate && date < endDate;
                                                        const isDisabled = date && (date < today && date.toDateString() !== today.toDateString()); 

                                                        let cellClasses = 'p-2 rounded-full cursor-pointer';
                                                        if (!date) {
                                                            cellClasses = 'p-2'; // Empty cell
                                                        } else if (isDisabled) {
                                                            cellClasses += ' text-gray-400 cursor-not-allowed';
                                                        } else if (isSelectedStart || isSelectedEnd) {
                                                            cellClasses += ' bg-purple-600 text-white font-bold';
                                                        } else if (isInRange) {
                                                            cellClasses += ' bg-purple-200 text-purple-800';
                                                        } else if (date.getDay() === 0) { // Sunday
                                                            cellClasses += ' text-red-500 hover:bg-gray-100';
                                                        } else if (date.getDay() === 6) { // Saturday
                                                            cellClasses += ' text-blue-500 hover:bg-gray-100';
                                                        } else {
                                                            cellClasses += ' hover:bg-gray-100';
                                                        }
                                                        if (isToday && !isSelectedStart && !isSelectedEnd) {
                                                            cellClasses += ' border-2 border-indigo-500'; // Highlight today if not selected
                                                        }

                                                        return (
                                                            <div
                                                                key={index}
                                                                className={cellClasses}
                                                                onClick={() => !isDisabled && handleDateClick(date)}
                                                            >
                                                                {date ? date.getDate() : ''}
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                                {startDate && endDate && (
                                                    <p className="text-lg font-semibold text-gray-800 mt-4 text-center">
                                                        선택 기간: {startDate.toLocaleDateString('ko-KR')} ~ {endDate.toLocaleDateString('ko-KR')} (총 {numNights}박 {numDays}일)
                                                    </p>
                                                )}
                                                {!startDate && !endDate && (
                                                    <p className="text-lg text-gray-600 mt-4 text-center">
                                                        숙박 시작일과 종료일을 선택해주세요.
                                                    </p>
                                                )}
                                            </div>
                                        </div>

                                        {/* 총 숙박 인원 입력 (Plus/Minus buttons) */}
                                        <div className="mb-4">
                                            <label htmlFor="total-guests-control" className="block text-gray-700 text-lg font-semibold mb-2">
                                                총 숙박 인원 (24개월 이상부터 카운트):
                                            </label>
                                            <div className="flex items-center space-x-2">
                                                <button
                                                    type="button"
                                                    onClick={handleGuestsDecrement}
                                                    className="p-3 bg-purple-200 text-purple-800 rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl hover:bg-purple-300 transition-colors duration-200"
                                                >
                                                    -
                                                </button>
                                                <span id="total-guests-control" className="p-3 bg-white border border-gray-300 rounded-lg shadow-sm text-lg font-semibold text-center w-20">
                                                    {totalGuests}
                                                </span>
                                                <button
                                                    type="button"
                                                    onClick={handleGuestsIncrement}
                                                    className="p-3 bg-purple-200 text-purple-800 rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl hover:bg-purple-300 transition-colors duration-200"
                                                >
                                                    +
                                                </button>
                                            </div>
                                        </div>
                                    </>
                                )}
                            </div>
                        )}

                        {/* 프리미엄 아이돌봄 서비스 섹션 */}
                        <div className="mb-6 bg-green-50 p-4 sm:p-6 rounded-2xl border border-green-200 shadow-sm">
                            <h2 className="text-xl sm:text-2xl font-bold text-green-700 mb-4 pb-2 border-b border-green-300">
                                프리미엄 아이돌봄 서비스
                            </h2>
                            <label className="flex items-center p-3 sm:p-4 bg-white rounded-xl shadow-md cursor-pointer hover:bg-green-100 transition-all duration-200 ease-in-out border border-gray-100 mb-4">
                                <input
                                    type="checkbox"
                                    checked={isChildcareServiceSelected}
                                    onChange={(e) => setIsChildcareServiceSelected(e.target.checked)}
                                    className="form-checkbox h-5 w-5 sm:h-6 sm:w-6 text-green-600 rounded-md focus:ring-green-500 transition duration-150 ease-in-out mr-3"
                                />
                                <div className="flex flex-col flex-grow">
                                    <span className="text-base sm:text-lg font-medium text-gray-800">
                                        아이돌봄 서비스 신청
                                    </span>
                                    <span className="text-sm sm:text-base text-gray-600">
                                        * 만 4세 ~ 12세 이하 자녀에게만 해당
                                    </span>
                                </div>
                            </label>

                            {isChildcareServiceSelected && (
                                <div className="mt-4 p-4 bg-green-100 rounded-xl border border-green-300">
                                    <p className="text-red-600 font-bold text-md sm:text-lg mb-2">
                                        ※ 일요일은 돌봄 서비스를 제공하지 않습니다.
                                    </p>
                                    <div className="mb-4">
                                        <label htmlFor="children-4-12-control" className="block text-gray-700 text-lg font-semibold mb-2">
                                            돌봄이 필요한 만 4세 ~ 만 12세 이하 자녀 수:
                                        </label>
                                        <div className="flex items-center space-x-2">
                                            <button
                                                type="button"
                                                onClick={handleChildrenDecrement}
                                                className="p-3 bg-green-200 text-green-800 rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl hover:bg-green-300 transition-colors duration-200"
                                            >
                                                -
                                            </button>
                                            <span id="children-4-12-control" className="p-3 bg-white border border-gray-300 rounded-lg shadow-sm text-lg font-semibold text-center w-20">
                                                {children4To12}
                                            </span>
                                            <button
                                                type="button"
                                                onClick={handleChildrenIncrement}
                                                className="p-3 bg-green-200 text-green-800 rounded-full w-10 h-10 flex items-center justify-center font-bold text-xl hover:bg-green-300 transition-colors duration-200"
                                            >
                                                +
                                            </button>
                                        </div>
                                        {children4To12 > totalGuests && (
                                            <p className="text-red-500 text-sm mt-1">자녀 수는 총 숙박 인원을 초과할 수 없습니다.</p>
                                        )}
                                        {children4To12 === 0 && isChildcareServiceSelected && (
                                            <p className="text-orange-500 text-sm mt-1">아이돌봄 서비스를 선택했지만, 돌봄이 필요한 자녀 수가 0명입니다.</p>
                                        )}
                                    </div>

                                    <p className="text-md font-bold text-gray-700 mb-2">
                                        돌봄 서비스 시간: {selectedLocation === '남해' ? CHILDCARE_CONFIG.hoursNamhae : CHILDCARE_CONFIG.hoursJecheon}
                                    </p>
                                    

                                    {children4To12 > 0 && (
                                        <> {/* Added Fragment to group multiple elements */}
                                            <div className="mt-4 p-4 bg-green-200 rounded-xl border border-green-400 text-gray-800">
                                                <h3 className="text-lg font-bold mb-2">돌봄 프로그램 구성표: 발도르프 프리미엄 돌봄</h3>
                                                <p className="text-sm text-gray-700 mb-3">
                                                    모든 프로그램이 진행됩니다. 아래 셀을 눌러 상세 설명을 확인하세요.
                                                </p>
                                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-2 mb-4">
                                                    {CHILDCARE_PROGRAMS[selectedLocation]?.map((programName) => (
                                                        <div
                                                            key={programName}
                                                            className={`p-3 rounded-lg cursor-pointer text-center text-sm font-medium transition-all duration-200
                                                                ${selectedProgramName === programName ? 'bg-green-600 text-white shadow-lg' : 'bg-white hover:bg-green-100 text-gray-800 shadow-sm border border-gray-200'}`}
                                                            onClick={() => handleProgramClick(programName)}
                                                        >
                                                            {programName}
                                                        </div>
                                                    ))}
                                                </div>

                                                {selectedProgramDescription && (
                                                    <div className="mt-4 p-3 bg-green-100 rounded-lg border border-green-300">
                                                        <p className="text-sm font-semibold mb-1">{selectedProgramName} 설명:</p>
                                                        <p className="text-sm">{selectedProgramDescription}</p>
                                                    </div>
                                                )}

                                                <h3 className="text-lg font-bold mt-4 mb-2">돌봄 비용 안내</h3>
                                                <p className="mb-1">
                                                    - 기본 돌봄비용 ({selectedLocation === '남해' ? '남해' : '제천'}):
                                                    {(selectedLocation === '남해' ? CHILDCARE_CONFIG.baseChildcareCostNamhae : CHILDCARE_CONFIG.baseChildcareCostJecheon).toLocaleString('ko-KR')}원 (1박 기준)
                                                </p>
                                                {children4To12 > CHILDCARE_CONFIG.baseChildcareGuests && (
                                                    <p className="mb-1">
                                                        - 인원 추가 비용 ({children4To12 - CHILDCARE_CONFIG.baseChildcareGuests}명):
                                                        {CHILDCARE_CONFIG.additionalChildcareFeePerChild.toLocaleString('ko-KR')}원 (1박당)
                                                    </p>
                                                )}
                                                <p className="text-sm text-gray-900 mt-2">
                                                    (돌봄교사 {Math.max(1, Math.ceil(children4To12 / CHILDCARE_CONFIG.maxChildrenPerTeacher))}명 투입)
                                                </p>
                                            </div>
                                            <p className="text-red-600 font-bold text-md sm:text-lg mt-2">
                                                * 돌봄비용은 돌봄 대관비, 프로그램 재료비, 교사 인건비가 포함된 금액입니다.
                                            </p>
                                        </>
                                    )}
                                </div>
                            )}
                        </div>

                        {/* 선택 옵션 상품 섹션 */}
                        <div className="mb-6 bg-yellow-50 p-4 sm:p-6 rounded-2xl border border-yellow-200 shadow-sm">
                            <h2 className="text-xl sm:text-2xl font-bold text-yellow-700 mb-4 pb-2 border-b border-yellow-300">
                                선택 옵션 상품
                            </h2>
                            {selectedLocation === '남해' ? (
                                <>
                                    <label className="flex items-center p-3 sm:p-4 bg-white rounded-xl shadow-md cursor-pointer hover:bg-yellow-100 transition-all duration-200 ease-in-out border border-gray-100 mb-4">
                                        <input
                                            type="checkbox"
                                            checked={isSocialDiningSelected}
                                            onChange={(e) => setIsSocialDiningSelected(e.target.checked)}
                                            className="form-checkbox h-5 w-5 sm:h-6 sm:w-6 text-yellow-600 rounded-md focus:ring-yellow-500 transition duration-150 ease-in-out mr-3"
                                        />
                                        <div className="flex flex-col flex-grow">
                                            <span className="text-base sm:text-lg font-medium text-gray-800">
                                                소셜 다이닝 (인당 {SOCIAL_DINING_CONFIG.costPerPerson.toLocaleString('ko-KR')}원)
                                            </span>
                                            <span className="text-sm sm:text-base text-gray-600">
                                                * 시기별 메뉴에 따라 재료 구성이 달라질 수 있습니다.
                                            </span>
                                        </div>
                                    </label>

                                    {isSocialDiningSelected && (
                                        <div className="mt-4 p-4 bg-yellow-100 rounded-xl border border-yellow-300 text-gray-800">
                                            <h3 className="text-lg font-bold mb-2">소셜 다이닝 메뉴 예시</h3>
                                            <ul className="list-disc list-inside ml-4">
                                                {SOCIAL_DINING_CONFIG.menuExamples.map((menu, index) => (
                                                    <li key={index} className="text-sm">{menu}</li>
                                                ))}
                                            </ul>
                                            <p className="text-md font-bold mt-2">
                                                총 소셜 다이닝 비용: {socialDiningOnlyCost.toLocaleString('ko-KR')}원
                                            </p>
                                        </div>
                                    )}
                                </>
                            ) : (
                                <p className="text-gray-600 italic">
                                    선택하신 지역 ({selectedLocation})에는 현재 제공되는 선택 옵션 상품이 없습니다.
                                </p>
                            )}
                        </div>

                        {/* 예약자 정보 입력 섹션 */}
                        <div className="mb-6 bg-gray-50 p-4 sm:p-6 rounded-2xl border border-gray-200 shadow-sm">
                            <h2 className="text-xl sm:text-2xl font-bold text-gray-700 mb-4 pb-2 border-b border-gray-300">
                                예약자 정보
                            </h2>
                            <div className="mb-4">
                                <label htmlFor="requester-name" className="block text-gray-700 text-lg font-semibold mb-2">
                                    예약자 이름: <span className="text-red-500">*</span>
                                </label>
                                <input
                                    type="text"
                                    id="requester-name"
                                    value={requesterName}
                                    onChange={(e) => setRequesterName(e.target.value)}
                                    className="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
                                    placeholder="이름을 입력해주세요"
                                    required
                                />
                            </div>
                            <div className="mb-4">
                                <label htmlFor="phone-number" className="block text-gray-700 text-lg font-semibold mb-2">
                                    전화번호: <span className="text-red-500">*</span>
                                </label>
                                <input
                                    type="tel"
                                    id="phone-number"
                                    value={phoneNumber}
                                    onChange={(e) => setPhoneNumber(e.target.value)}
                                    className="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
                                    placeholder="예: 010-1234-5678"
                                    required
                                />
                            </div>
                        </div>


                        {/* 최종 견적 금액 표시 섹션 */}
                        <div className="mt-8 pt-6 border-t-2 border-indigo-300 text-center">
                            <p className="text-2xl sm:text-3xl font-extrabold text-indigo-900">
                                총 견적: <span className="text-purple-600">{totalEstimate.toLocaleString('ko-KR')}원 (부가세 포함)</span>
                            </p>
                            <p className="text-sm text-gray-500 mt-2">
                                선택된 숙소, 아이돌봄 서비스, 선택 옵션 상품들의 총합입니다.
                            </p>
                        </div>

                        {/* 예약 상담하기 버튼 */}
                        <div className="mt-8 text-center">
                            <button
                                onClick={handleSubmitBooking}
                                className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-300"
                            >
                                예약 상담하기
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
